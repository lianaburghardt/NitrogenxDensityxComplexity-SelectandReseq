mycols<-mycols[match(myorder,mycols$Strain),]
mdfr$Strain<-factor(mdfr$Strain, levels = c(myorder))
A17_pools$Trt <- NULL
myorder<-colnames(A17_pools[-c(1:2)])[order(colMeans(A17_pools[,-c(1:2)]),decreasing=TRUE)]
#myorder<-c(as.character(mycols$Strain),levels(mdfr$Strain)[!levels(mdfr$Strain) %in% mycols$Strain])
mycols<-mycols[match(myorder,mycols$Strain),]
mdfr$Strain<-factor(mdfr$Strain, levels = c(myorder))
ggplot(mdfr, aes(Environment, value, fill = Strain)) +
#  ggplot(mdfr, aes(pool, value, fill = Strain)) +
geom_bar(position = "fill", stat = "identity")+
scale_y_continuous(labels = percent)+
scale_fill_manual(values = paste(mycols$colors))+
ggtitle("All Strains")+
theme_minimal()
pdf(file="../figures/FigureS3_NoduleComposition_N*D.pdf",height = 6,width=9,fonts = "Helvetica",useDingbats = FALSE)
ggplot(mdfr, aes(Environment, value, fill = Strain)) +
#  ggplot(mdfr, aes(pool, value, fill = Strain)) +
geom_bar(position = "fill", stat = "identity")+
scale_y_continuous(labels = percent)+
scale_fill_manual(values = paste(mycols$colors))+
ggtitle("All Strains")+
theme_minimal()
dev.off()
pdf(file="../figures/FigureS3_NoduleComposition_N*D.pdf",height = 6,width=9,fonts = "Helvetica",useDingbats = FALSE)
ggplot(mdfr, aes(Environment, value, fill = Strain)) +
#  ggplot(mdfr, aes(pool, value, fill = Strain)) +
geom_bar(position = "fill", stat = "identity")+
scale_y_continuous(labels = percent)+
scale_fill_manual(values = paste(mycols$colors))+
theme_minimal()
dev.off()
pdf(file="../figures/FigureS3_NoduleComposition_N*D.pdf",height = 6,width=8,fonts = "Helvetica",useDingbats = FALSE)
ggplot(mdfr, aes(Environment, value, fill = Strain)) +
#  ggplot(mdfr, aes(pool, value, fill = Strain)) +
geom_bar(position = "fill", stat = "identity")+
scale_y_continuous(labels = percent)+
scale_fill_manual(values = paste(mycols$colors))+
theme_minimal()
dev.off()
pdf(file="../figures/FigureS3_NoduleComposition_N*D.pdf",height = 6,width=6,fonts = "Helvetica",useDingbats = FALSE)
ggplot(mdfr, aes(Environment, value, fill = Strain)) +
#  ggplot(mdfr, aes(pool, value, fill = Strain)) +
geom_bar(position = "fill", stat = "identity")+
scale_y_continuous(labels = percent)+
scale_fill_manual(values = paste(mycols$colors))+
theme_minimal()
dev.off()
pdf(file="../figures/FigureS3_NoduleComposition_N*D.pdf",height = 6,width=7,fonts = "Helvetica",useDingbats = FALSE)
ggplot(mdfr, aes(Environment, value, fill = Strain)) +
#  ggplot(mdfr, aes(pool, value, fill = Strain)) +
geom_bar(position = "fill", stat = "identity")+
scale_y_continuous(labels = percent)+
scale_fill_manual(values = paste(mycols$colors))+
theme_minimal()
dev.off()
Prop
View(freqs)
freqs<-freqsC68
View(freqsC68)
mdfr
Prop
View(freqs)
View(freq)
freqsC68 = read.csv('../Data/2018-10-19_core_strain_freqs/C68freq.tsv',
sep='\t', header=TRUE, as.is=TRUE)
# Store initial frequencies for standardizing and remove from data set
initial<-freqsC68[grep(pattern = "initial",x = freqsC68$pool),]
initial_means = apply(initial[,-1], 2, mean)
freqs<-freqsC68[-grep(pattern = "initial",x = freqsC68$pool),]
trts<-data.frame(do.call('rbind',strsplit(freqs$pool,"[_]")))
colnames(trts)<-c("Community","Host","trt_rep")
trts$trt<-gsub('([A-Z]+)[0-9]+','\\1',trts$trt_rep)
trts$rep<-as.numeric(gsub('[A-Z]+([0-9]+)','\\1',trts$trt_rep))
trts$Density <- "L"
trts[trts$trt=="X"|trts$trt=="N",]$Density <- "H"
trts$Nitrogen <- "X"
trts[trts$trt=="LN"|trts$trt=="N",]$Nitrogen <- "N"
trts$trt<-factor(trts$trt,levels = c("X","N","L","LN"),labels=c("HiD","HiD+N","LoD","LoD+N"))
trts$Host_trt<-paste(trts$Host,trts$trt,sep="_")
trts$Host_trt<-factor(trts$Host_trt)
trts$Host_trt_rep<-paste(trts$Host_trt,trts$rep,sep="_")
mine<-as.matrix(freqs[,-1])
mine<-log2(mine/initial_means)
mine[mine< (-8)]<- (-8)
fitness<-data.frame(trts,mine)  #### Relative fitness values with metadata
freqs<-data.frame(trts,as.matrix(freqs[,-1]))  ### Raw frequency values w/ metadata
freqs
initial
rbind(freqs,initial)
rbind(freqs,c("Host",initial)
)
c("Host",initial)
cbind("Host",initial)
colnames(freqs)
rbind(freqs[,c(-1:-7,-9)],cbind(initial",initial))
)
)
(freqs[,c(-1:-7,-9)]
)
rbind(freqs[,c(-1:-7,-9)],cbind("initial",initial))
cbind("initial",initial)
dim(cbind("initial",initial))
rbind(freqs[,c(-1:-7,-9)],cbind("initial",initial[,-1]))
rbind(freqs[,c(-1:-7,-9)],cbind(Host_trt="initial",initial[,-1]))
Prop<-rbind(freqs[,c(-1:-7,-9)],cbind(Host_trt="initial",initial[,-1]))
mdfr <- melt(Prop, id.vars = c("Host_trt"))
mdfr
mdfr$value <-as.numeric(mdfr$value)
colnames(mdfr)<-c("Environment","Strain","value")
head(mdfr)
ggplot(mdfr, aes(Environment, value, fill = Strain)) +
geom_bar(position = "fill", stat = "identity")+
scale_y_continuous(labels = percent)+
scale_fill_manual(values = paste(mycols$colors))+
theme_minimal()
set.seed(seed = 2)
mycols<-data.frame(Strain=c("HM006.1","M162","KH46C","KH35C","M270","T073","USDA1021", "USDA1157"),
colors=c("darkblue","darkgoldenrod","olivedrab","darkred","black","gold","darkorange","lightblue"))
mdfr$Strain<-factor(mdfr$Strain, levels = c(as.character(mycols$Strain),levels(mdfr$Strain)[!levels(mdfr$Strain) %in% mycols$Strain]))
mine<-data.frame(Strain=levels(mdfr$Strain)[!levels(mdfr$Strain) %in% mycols$Strain],colors=sample(gray.colors(n = 60,start = .05,end=1),size = 60))
mycols<-rbind(mycols,mine)
A17_pools$Trt <- NULL
myorder<-colnames(A17_pools[-c(1:2)])[order(colMeans(A17_pools[,-c(1:2)]),decreasing=TRUE)]
mycols<-mycols[match(myorder,mycols$Strain),]
mdfr$Strain<-factor(mdfr$Strain, levels = c(myorder))
ggplot(mdfr, aes(Environment, value, fill = Strain)) +
geom_bar(position = "fill", stat = "identity")+
scale_y_continuous(labels = percent)+
scale_fill_manual(values = paste(mycols$colors))+
theme_minimal()
mdfr$Environment<- factor(mdfr$Environment,levels=c("A17_HiD","A17_HiD+N","A17_LoD","A17_LoD+N","initial","R108_HiD","R108_HiD+N","R108_LoD","R108_LoD+N"))
ggplot(mdfr, aes(Environment, value, fill = Strain)) +
geom_bar(position = "fill", stat = "identity")+
scale_y_continuous(labels = percent)+
scale_fill_manual(values = paste(mycols$colors))+
theme_minimal()
pdf(file="../figures/FigureS3_NoduleComposition_N*D.pdf",height = 6,width=7,fonts = "Helvetica",useDingbats = FALSE)
ggplot(mdfr, aes(Environment, value, fill = Strain)) +
geom_bar(position = "fill", stat = "identity")+
scale_y_continuous(labels = percent)+
scale_fill_manual(values = paste(mycols$colors))+
theme_minimal()
dev.off()
plot(jitter(C8$C8rank),C8$C68rank,pch=as.numeric(as.factor(C8$Host),fill=))
C8
rbind(freqsC8,freqsC68sub8)
freqsC68sub<-rbind(freqsC68[grep(pattern = "A17_X",x = freqsC68$pool),], freqsC68[grep(pattern = "R108_X",x = freqsC68$pool),],freqsC68[grep(pattern = "initial",x = freqsC68$pool),])
freqsC68sub8<-freqsC68sub[,colnames(freqsC68sub) %in% colnames(freqsC8)]
freqsC68sub3<-freqsC68sub[,colnames(freqsC68sub) %in% colnames(freqsC3)]
freqsC68subHM<-freqsC68sub[,colnames(freqsC68sub) %in% colnames(freqsHM)]
freqsC8subHM<-freqsC8[,colnames(freqsC8) %in% colnames(freqsHM)]
freqsC3subHM<-freqsC3[,colnames(freqsC3) %in% colnames(freqsHM)]
freqsC68subKH<-freqsC68sub[,colnames(freqsC68sub) %in% colnames(freqsKH)]
freqsC8subKH<-freqsC8[,colnames(freqsC8) %in% colnames(freqsKH)]
freqsC3subKH<-freqsC3[,colnames(freqsC3) %in% colnames(freqsKH)]
freqsC68subMK<-freqsC68sub[,colnames(freqsC68sub) %in% colnames(freqsMK)]
freqsC8subMK<-freqsC8[,colnames(freqsC8) %in% colnames(freqsMK)]
freqsC3subMK<-freqsC3[,colnames(freqsC3) %in% colnames(freqsMK)]
FrequencyAll(freqsHM, "HM Pairwise")
pdf(file="../figures/FigureS6_RelativeAbundanceAcrossComplexity.pdf",height = 4,width=3,fonts = "Helvetica",useDingbats = FALSE)
FrequencyAll(freqsHM, "HM Pairwise")
FrequencyAll(freqsKH,"KH Pairwise")
FrequencyAll(freqsMK, "MK Pairwise")
FrequencyAll(freqsC3, "C3 Community")
FrequencyAll(freqsC8sub3, "C3 Strains in C8")
FrequencyAll(freqsC68sub3, "C3 Strains in C68")
FrequencyAll(freqsC8, "C8 Community")
FrequencyAll(freqsC68sub8, "C8 Strains in C68")
dev.off()
rbind(freqsC8,freqsC68sub8)
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% filter(pool,grep(pattern = "A17"))
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% filter(pool,grep(x,pattern = "A17"))
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% filter(pool==grep(x,pattern = "A17"))
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_")
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>% filter(Host=="initial")
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>% filter(Host!="initial")
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>% filter(Host!="initial") %>% group_by(c(Host,Community)) %>% summarize_if(is.numeric, mean)
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>% filter(Host!="initial") %>% group_by(Host,Community) %>% summarize_if(is.numeric, mean)
C8<-as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% group_by(Host,Community) %>% summarize_if(is.numeric, mean)
C8
C8 %>% mutate_at(USDA1157:KH46C,.funs = dense_rank)
t(C*)
t(C*)
t(C8)
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Host,Community)
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community))
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, mean)
C8<-as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, mean)
t(C8)
C8 %>% rownames_to_column()
C8 %>% pivot_longer(-rowname,'Strain','freq')
C8 %>% pivot_longer('Strain','freq')
C8 %>% pivot_longer('Combo','freq')
C8
C8 %>% pivot_longer(USDA1157:KH46C,'freq')
C8 %>% pivot_longer(USDA1157:KH46C,'Strain','freq')
C8 %>% pivot_longer(USDA1157:KH46C,'Strain','freq') %>% pivot_wider(Combo)
C8<-as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, mean)
C8 %>% pivot_longer(USDA1157:KH46C,'Strain','freq') %>% pivot_wider(Combo)
C8 %>% pivot_longer(USDA1157:KH46C,'Strain','freq') %>% pivot_wider(names_from=Combo,values_from=freq)
C8 %>% pivot_longer(USDA1157:KH46C,'Strain','freq') %>% pivot_wider(names_from=Combo,values_from=Strain)
C8
C8 %>% pivot_longer(USDA1157:KH46C,'Strain','freq')
C8 %>% pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq')
C8 %>% pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=Strain)
C8 %>% pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq)
C8 %>% pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,rank)
C8<-as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, median)
C8 %>% pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,rank)
C8 %>% pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,dense_rank)
C8 %>% pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,rev(dense_rank),)
C8 %>% pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,dense_rank,)
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, mean) %>%
pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,dense_rank(-x))
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, mean) %>%
pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,desc(dense_rank()))
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, mean) %>%
pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,desc(dense_rank(x)))
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, mean) %>%
pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,dense_rank)
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, mean) %>%
pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,-) %>% mutate_if(is.double,dense_rank)
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, mean) %>%
pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,-x) %>% mutate_if(is.double,dense_rank)
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, mean) %>%
pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,function(x) desc(dense_rank(x)))
as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, mean) %>%
pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,function(x) dense_rank(-x))
mycols
C8<-as.tibble(rbind(freqsC8,freqsC68sub8)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, mean) %>%
pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,function(x) dense_rank(-x))
mycols<-data.frame(Strain=c("HM006.1","M162","KH46C","KH35C","M270","T073","USDA1021", "USDA1157"),
colors=c("darkblue","darkgoldenrod","olivedrab","darkred","black","gold","darkorange","lightblue"))
plot(jitter(C8$A17_C68),C8$C8$A17_C68,pch=1,fill=mycols$colors))
plot(jitter(C8$A17_C68),C8$C8$A17_C68,pch=1,fill=mycols$colors)
plot(jitter(C8$A17_C68)~C8$C8$A17_C68,pch=1,fill=mycols$colors)
plot(jitter(C8$A17_C68)~C8$A17_C8,pch=1,fill=mycols$colors)
plot(jitter(C8$A17_C68)~C8$A17_C8,pch=1,col=mycols$colors)
mycols$colors
plot(jitter(C8$A17_C68)~C8$A17_C8,pch=1,col=paste(mycols$colors))
C8$Strain
mycols[C8$Strain,]
mycols$Strain[C8$Strain,]
mycols$Strain[C8$Strain]
mycols$Strain
C8$Strain
C8$Strain %in% mycols$Strain
mycols[Strain=paste(C8$Strain),]
mycols[Strain=+paste(C8$Strain),]
mycols[Strain=+paste(C8$Strain),]
order(C8$Strain)
mycols[order(C8$Strain)]
mycols[order(C8$Strain),]
mycols[order(C8$A17_C68),]
C8$A17_C68
mycols[C8$A17_C68,]
match(C8$A17_C68,mycols$Strain)
mycols$Strain[C8$A17_C68,]
mycols$Strain[C8$A17_C68]
mycols[C8$A17_C68,]
plot(jitter(C8$A17_C68)~C8$A17_C8,pch=1,col=mycols[C8$A17_C68,]$colors)
plot(jitter(C8$A17_C68)~C8$A17_C8,pch=1,col=paste(mycols[C8$A17_C68,]$colors))
mycols[C8$Strains,]$colors
mycols[C8$Strain,]$colors
mycols[paste(C8$Strain),]$colors
C8
merge(C8,mycols,by="Strain")
C8<-merge(C8,mycols,by="Strain")
plot(jitter(C8$A17_C68)~C8$A17_C8,pch=1,col=paste(C8$colors))
plot(jitter(C8$A17_C68)~C8$A17_C8,pch=19,col=paste(C8$colors))
plot(jitter(C8$R108_C68)~C8$R108_C8,pch=20,col=paste(C8$colors))
plot(jitter(C8$R108_C68)~C8$R108_C8,pch=17,col=paste(C8$colors))
plot(jitter(C8$A17_C68)~C8$A17_C8,pch=19,col=paste(C8$colors))
points(jitter(C8$R108_C68)~C8$R108_C8,pch=17,col=paste(C8$colors),add=TRUE)
plot(jitter(C8$A17_C68)~C8$A17_C8,pch=19,col=paste(C8$colors))
points(jitter(C8$R108_C68)~C8$R108_C8,pch=17,col=paste(C8$colors))
C3<-as.tibble(rbind(freqsC3,freqsC68sub3)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, mean) %>%
pivot_longer(USDA1157:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,function(x) dense_rank(-x))
as.tibble(rbind(freqsC3,freqsC68sub3)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, mean)
C3<-as.tibble(rbind(freqsC3,freqsC68sub3)) %>% separate(pool,into=c("Community","Host",NA),sep = "_") %>%
filter(Host!="initial") %>% unite(Combo,c(Host,Community)) %>% group_by(Combo) %>% summarize_if(is.numeric, mean) %>%
pivot_longer(HM006.1:KH46C,'Strain',values_to = 'freq') %>% pivot_wider(names_from=Combo,values_from=freq) %>% mutate_if(is.double,function(x) dense_rank(-x))
C3
merge(C3,mycols,by="Strain",all.x = TRUE)
C3<-merge(C3,mycols,by="Strain",all.x = TRUE)
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors))
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors),xlab="Rank in C8",ylab="Rank in C68")
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors),xlab="Rank in C8",ylab="Rank in C68",axes=FALSE)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
pdf(file="../figures/Figure 4b_rankC8inC68.pdf", height=5,width=5,useDingbats = FALSE)
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors),xlab="Rank in C8",ylab="Rank in C68",axes=FALSE)
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
dev.off()
pdf(file="../figures/Figure4b_rankC8inC68.pdf", height=5,width=5,useDingbats = FALSE)
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors),xlab="Rank in C8",ylab="Rank in C68",axes=FALSE)
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
dev.off()
pdf(file="../figures/Figure4b_rankC8inC68.pdf", height=4,width=4,useDingbats = FALSE)
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors),xlab="Rank in C8",ylab="Rank in C68",axes=FALSE)
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
dev.off()
plot(jitter(C3$A17_C68,factor=.5)~C3$A17_C3,pch=19,col=paste(C3$colors),xlab="Rank in C3",ylab="Rank in C68",axes=FALSE)
points(jitter(C3$R108_C68,factor=.5)~C3$R108_C3,pch=17,col=paste(C3$colors))
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
axis(side = 1)
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors),xlab="Rank in C8",ylab="Rank in C68",axes=FALSE)
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
axis(side = 1,at = c(1:3))
axis(side = 2 )
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors),xlab="Rank in C8",ylab="Rank in C68",axes=FALSE)
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
axis(side = 1,at = c(1:8))
axis(side = 2 )
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
pdf(file="../figures/Figure4b_rankC8inC68.pdf", height=4,width=4,useDingbats = FALSE)
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors),xlab="Rank in C8",ylab="Rank in C68",axes=FALSE)
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
axis(side = 1,at = c(1:8))
axis(side = 2 )
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
dev.off()
pdf(file="../figures/Figure4b_rankC8inC68.pdf", height=4,width=4,useDingbats = FALSE)
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors),xlab="Rank in C8",ylab="Rank in C68",axes=FALSE)
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
axis(side = 1,at = c(1:8))
axis(side = 2 )
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
dev.off()
dev.off()
pdf(file="../figures/Figure4b_rankC8inC68.pdf", height=4,width=4,useDingbats = FALSE)
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors),xlab="Rank in C8",ylab="Rank in C68",axes=FALSE)
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
axis(side = 1,at = c(1:8))
axis(side = 2 )
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
dev.off()
pdf(file="../figures/Figure4b_rankC8inC68.pdf", height=5,width=5,useDingbats = FALSE)
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors),xlab="Rank in C8",ylab="Rank in C68",axes=FALSE)
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
axis(side = 1,at = c(1:8))
axis(side = 2 )
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
dev.off()
plot(jitter(C3$A17_C68,factor=.5)~C3$A17_C3,pch=19,col=paste(C3$colors),xlab="Rank in C3",ylab="Rank in C68",axes=FALSE)
points(jitter(C3$R108_C68,factor=.5)~C3$R108_C3,pch=17,col=paste(C3$colors))
axis(side = 1,at = c(1:3))
axis(side = 2 )
axis(side = 2, at = c(1:3))
plot(jitter(C3$A17_C68,factor=.5)~C3$A17_C3,pch=19,col=paste(C3$colors),xlab="Rank in C3",ylab="Rank in C68",axes=FALSE)
points(jitter(C3$R108_C68,factor=.5)~C3$R108_C3,pch=17,col=paste(C3$colors))
axis(side = 1,at = c(1:3))
axis(side = 2, at = c(1:3))
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
pdf(file="../figures/Figure4a_rankC3inC68.pdf", height=4,width=4,useDingbats = FALSE)
plot(jitter(C3$A17_C68,factor=.5)~C3$A17_C3,pch=19,col=paste(C3$colors),xlab="Rank in C3",ylab="Rank in C68",axes=FALSE)
points(jitter(C3$R108_C68,factor=.5)~C3$R108_C3,pch=17,col=paste(C3$colors))
axis(side = 1,at = c(1:3))
axis(side = 2, at = c(1:3))
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
dev.off()
Pheno_HND
boxplot(Nodnum_per_plant~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Nodule number per plant",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = paste(levels(Pheno_HND$Trt)))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
points(Pheno_HND$Nodnum_per_plant~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
mycols<-c("#d73027","#fc8d59","#4575b4","#91bfdb")
boxplot(Nodnum_per_plant~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Nodule number per plant",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = paste(levels(Pheno_HND$Trt)))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
points(Pheno_HND$Nodnum_per_plant~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
boxplot(Veg_per_plant~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Veg biomass per plant (g)",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = c(paste(levels(Pheno_HND$Treatment)),paste(levels(Pheno_HND$Treatment))))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
points(Pheno_HND$Veg_per_plant~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(2.5,6.5),y=c(.7,.7),labels=c("A17","R108"))
pdf(file = "../figures/FigureS7_PlantBoxplot_N*D.pdf",height=5,width=6.5, useDingbats = FALSE)
boxplot(Veg_per_plant~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Veg biomass per plant (g)",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = c(paste(levels(Pheno_HND$Treatment)),paste(levels(Pheno_HND$Treatment))))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
points(Pheno_HND$Veg_per_plant~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(2.5,6.5),y=c(.7,.7),labels=c("A17","R108"))
boxplot(Root_per_plant~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Root biomass per plant (g)",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = c(paste(levels(Pheno_HND$Treatment)),paste(levels(Pheno_HND$Treatment))))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
points(Pheno_HND$Root_per_plant~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(2.5,6.5),y=c(.7,.7),labels=c("A17","R108"))
boxplot(RootShoot~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Root:Shoot ratio",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = c(paste(levels(Pheno_HND$Treatment)),paste(levels(Pheno_HND$Treatment))))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
abline(h = 1,col="grey",lty=1)
points(Pheno_HND$RootShoot~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(2.5,6.5),y=c(2,2),labels=c("A17","R108"))
boxplot(RootShoot~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Root:Shoot ratio",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = c(paste(levels(Pheno_HND$Treatment)),paste(levels(Pheno_HND$Treatment))))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
abline(h = 1,col="grey",lty=1)
points(Pheno_HND$RootShoot~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(2.5,6.5),y=c(2,2),labels=c("A17","R108"))
dev.off()
pdf(file = "../figures/FigureS2a_PlantBoxplot_N*D.pdf",height=5,width=6.5, useDingbats = FALSE)
boxplot(Nod_num~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Nodule number sampled",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = c(paste(levels(Pheno_HND$Treatment)),paste(levels(Pheno_HND$Treatment))))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
points(Pheno_HND$Nod_num~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(2.5,6.5),y=c(550,550),labels=c("A17","R108"))
dev.off()
mycols.x<-rev(c("#ffffcc","#c2e699","#78c679","#238443"))
boxplot(Nodnum_per_plant~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Nodule per plant",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$Nodnum_per_plant~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(3.5,9.5),y=c(135,135),labels=c("A17","R108"))
boxplot(Nod_num~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Nodule pool",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$Nod_num~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(1.5,7.5),y=c(650,650),labels=c("A17","R108"))
abline(h=1,col="grey")
pdf(file = "../figures/FigureS8_ComplexityPhenotypes.pdf",height=5,width=7)
boxplot(Nodnum_per_plant~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Nodule per plant",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$Nodnum_per_plant~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(3.5,9.5),y=c(135,135),labels=c("A17","R108"))
boxplot(weight_per_Nod*1000~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Mean nodule wieght (mg)",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$weight_per_Nod*1000~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(3.5,9.5),y=c(5.8,5.8),labels=c("A17","R108"))
boxplot(Nodweight_per_plant*1000~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Nodule wieght per plant (mg)",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$Nodweight_per_plant*1000~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(3.5,9.5),y=c(105,105),labels=c("A17","R108"))
boxplot(Veg_per_plant*1000~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Vegetative biomass per plant (mg)",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$Veg_per_plant*1000~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(3.5,9.5),y=c(550,550),labels=c("A17","R108"))
boxplot(Root_per_plant*1000~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Root biomass per plant (mg)",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$Root_per_plant*1000~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(3.5,9.5),y=c(650,650),labels=c("A17","R108"))
boxplot(RootShoot~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Root:Shoot ratio",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$RootShoot~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(3.5,9.5),y=c(1.9,1.9),labels=c("A17","R108"))
abline(h=1,col="grey")
dev.off()
pdf(file = "../figures/FigureS2b_ComplexityNodulesSampled.pdf",height=5,width=7)
boxplot(Nod_num~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Nodule pool",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$Nod_num~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(1.5,7.5),y=c(650,650),labels=c("A17","R108"))
abline(h=1,col="grey")
dev.off()
Pheno_Complexity$Host<- factor(Pheno_Complexity$Host,levels=c("R108","A17"))
