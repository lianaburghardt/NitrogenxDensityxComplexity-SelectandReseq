pdf(file="../figures/Figure4b_rankC8inC68.pdf", height=4,width=4,useDingbats = FALSE)
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors),xlab="Rank in C8",ylab="Rank in C68",axes=FALSE)
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
axis(side = 1,at = c(1:8))
axis(side = 2 )
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
dev.off()
pdf(file="../figures/Figure4b_rankC8inC68.pdf", height=4,width=4,useDingbats = FALSE)
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors),xlab="Rank in C8",ylab="Rank in C68",axes=FALSE)
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
axis(side = 1,at = c(1:8))
axis(side = 2 )
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
dev.off()
dev.off()
pdf(file="../figures/Figure4b_rankC8inC68.pdf", height=4,width=4,useDingbats = FALSE)
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors),xlab="Rank in C8",ylab="Rank in C68",axes=FALSE)
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
axis(side = 1,at = c(1:8))
axis(side = 2 )
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
dev.off()
pdf(file="../figures/Figure4b_rankC8inC68.pdf", height=5,width=5,useDingbats = FALSE)
plot(jitter(C8$A17_C68,factor=.5)~C8$A17_C8,pch=19,col=paste(C8$colors),xlab="Rank in C8",ylab="Rank in C68",axes=FALSE)
points(jitter(C8$R108_C68,factor=.5)~C8$R108_C8,pch=17,col=paste(C8$colors))
axis(side = 1,at = c(1:8))
axis(side = 2 )
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
dev.off()
plot(jitter(C3$A17_C68,factor=.5)~C3$A17_C3,pch=19,col=paste(C3$colors),xlab="Rank in C3",ylab="Rank in C68",axes=FALSE)
points(jitter(C3$R108_C68,factor=.5)~C3$R108_C3,pch=17,col=paste(C3$colors))
axis(side = 1,at = c(1:3))
axis(side = 2 )
axis(side = 2, at = c(1:3))
plot(jitter(C3$A17_C68,factor=.5)~C3$A17_C3,pch=19,col=paste(C3$colors),xlab="Rank in C3",ylab="Rank in C68",axes=FALSE)
points(jitter(C3$R108_C68,factor=.5)~C3$R108_C3,pch=17,col=paste(C3$colors))
axis(side = 1,at = c(1:3))
axis(side = 2, at = c(1:3))
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
pdf(file="../figures/Figure4a_rankC3inC68.pdf", height=4,width=4,useDingbats = FALSE)
plot(jitter(C3$A17_C68,factor=.5)~C3$A17_C3,pch=19,col=paste(C3$colors),xlab="Rank in C3",ylab="Rank in C68",axes=FALSE)
points(jitter(C3$R108_C68,factor=.5)~C3$R108_C3,pch=17,col=paste(C3$colors))
axis(side = 1,at = c(1:3))
axis(side = 2, at = c(1:3))
legend("topleft",legend=c("A17","R108"),pch = c(19,17))
dev.off()
Pheno_HND
boxplot(Nodnum_per_plant~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Nodule number per plant",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = paste(levels(Pheno_HND$Trt)))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
points(Pheno_HND$Nodnum_per_plant~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
mycols<-c("#d73027","#fc8d59","#4575b4","#91bfdb")
boxplot(Nodnum_per_plant~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Nodule number per plant",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = paste(levels(Pheno_HND$Trt)))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
points(Pheno_HND$Nodnum_per_plant~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
boxplot(Veg_per_plant~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Veg biomass per plant (g)",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = c(paste(levels(Pheno_HND$Treatment)),paste(levels(Pheno_HND$Treatment))))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
points(Pheno_HND$Veg_per_plant~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(2.5,6.5),y=c(.7,.7),labels=c("A17","R108"))
pdf(file = "../figures/FigureS7_PlantBoxplot_N*D.pdf",height=5,width=6.5, useDingbats = FALSE)
boxplot(Veg_per_plant~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Veg biomass per plant (g)",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = c(paste(levels(Pheno_HND$Treatment)),paste(levels(Pheno_HND$Treatment))))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
points(Pheno_HND$Veg_per_plant~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(2.5,6.5),y=c(.7,.7),labels=c("A17","R108"))
boxplot(Root_per_plant~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Root biomass per plant (g)",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = c(paste(levels(Pheno_HND$Treatment)),paste(levels(Pheno_HND$Treatment))))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
points(Pheno_HND$Root_per_plant~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(2.5,6.5),y=c(.7,.7),labels=c("A17","R108"))
boxplot(RootShoot~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Root:Shoot ratio",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = c(paste(levels(Pheno_HND$Treatment)),paste(levels(Pheno_HND$Treatment))))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
abline(h = 1,col="grey",lty=1)
points(Pheno_HND$RootShoot~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(2.5,6.5),y=c(2,2),labels=c("A17","R108"))
boxplot(RootShoot~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Root:Shoot ratio",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = c(paste(levels(Pheno_HND$Treatment)),paste(levels(Pheno_HND$Treatment))))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
abline(h = 1,col="grey",lty=1)
points(Pheno_HND$RootShoot~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(2.5,6.5),y=c(2,2),labels=c("A17","R108"))
dev.off()
pdf(file = "../figures/FigureS2a_PlantBoxplot_N*D.pdf",height=5,width=6.5, useDingbats = FALSE)
boxplot(Nod_num~Trt,col=mycols[c(1:4,1:4)],xlab="Treatment",ylab="Nodule number sampled",outline=FALSE,axes=FALSE,lty=1, data=Pheno_HND)
axis(side = 1,at = c(1:8),labels = c(paste(levels(Pheno_HND$Treatment)),paste(levels(Pheno_HND$Treatment))))
axis(side = 2 )
abline(v = 4.5,col="black",lty=2)
points(Pheno_HND$Nod_num~jitter(as.numeric(Pheno_HND$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(2.5,6.5),y=c(550,550),labels=c("A17","R108"))
dev.off()
mycols.x<-rev(c("#ffffcc","#c2e699","#78c679","#238443"))
boxplot(Nodnum_per_plant~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Nodule per plant",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$Nodnum_per_plant~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(3.5,9.5),y=c(135,135),labels=c("A17","R108"))
boxplot(Nod_num~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Nodule pool",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$Nod_num~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(1.5,7.5),y=c(650,650),labels=c("A17","R108"))
abline(h=1,col="grey")
pdf(file = "../figures/FigureS8_ComplexityPhenotypes.pdf",height=5,width=7)
boxplot(Nodnum_per_plant~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Nodule per plant",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$Nodnum_per_plant~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(3.5,9.5),y=c(135,135),labels=c("A17","R108"))
boxplot(weight_per_Nod*1000~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Mean nodule wieght (mg)",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$weight_per_Nod*1000~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(3.5,9.5),y=c(5.8,5.8),labels=c("A17","R108"))
boxplot(Nodweight_per_plant*1000~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Nodule wieght per plant (mg)",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$Nodweight_per_plant*1000~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(3.5,9.5),y=c(105,105),labels=c("A17","R108"))
boxplot(Veg_per_plant*1000~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Vegetative biomass per plant (mg)",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$Veg_per_plant*1000~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(3.5,9.5),y=c(550,550),labels=c("A17","R108"))
boxplot(Root_per_plant*1000~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Root biomass per plant (mg)",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$Root_per_plant*1000~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(3.5,9.5),y=c(650,650),labels=c("A17","R108"))
boxplot(RootShoot~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Root:Shoot ratio",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$RootShoot~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(3.5,9.5),y=c(1.9,1.9),labels=c("A17","R108"))
abline(h=1,col="grey")
dev.off()
pdf(file = "../figures/FigureS2b_ComplexityNodulesSampled.pdf",height=5,width=7)
boxplot(Nod_num~Trt,col=mycols.x[c(1:4,4,4,1:4,4,4)],xlab="Community",ylab="Nodule pool",outline=FALSE,axes=FALSE,lty=1, data=Pheno_Complexity)
axis(side = 1,at = c(1:12),labels = c(paste(levels(Pheno_Complexity$Community)),paste(levels(Pheno_Complexity$Community))))
axis(side = 2 )
abline(v = 6.5,col="black",lty=2)
points(Pheno_Complexity$Nod_num~jitter(as.numeric(Pheno_Complexity$Trt)),col=c("black"), pch=19 , ylim=c(.25,.75),cex=.75)
text(x=c(1.5,7.5),y=c(650,650),labels=c("A17","R108"))
abline(h=1,col="grey")
dev.off()
Pheno_Complexity$Host<- factor(Pheno_Complexity$Host,levels=c("R108","A17"))
getwd()
freqsC68 = read.csv('../Data/2018-10-19_core_strain_freqs/C68freq.tsv',
sep='\t', header=TRUE, as.is=TRUE)
initial<-freqsC68[grep(pattern = "initial",x = freqsC68$pool),]
initial_means = apply(initial[,-1], 2, mean)
freqs<-freqsC68[-grep(pattern = "initial",x = freqsC68$pool),]
trts<-data.frame(do.call('rbind',strsplit(freqs$pool,"[_]")))
colnames(trts)<-c("Community","Host","trt_rep")
trts$trt<-gsub('([A-Z]+)[0-9]+','\\1',trts$trt_rep)
trts$rep<-as.numeric(gsub('[A-Z]+([0-9]+)','\\1',trts$trt_rep))
trts$Density <- "L"
trts[trts$trt=="X"|trts$trt=="N",]$Density <- "H"
trts$Nitrogen <- "X"
trts[trts$trt=="LN"|trts$trt=="N",]$Nitrogen <- "N"
trts$trt<-factor(trts$trt,levels = c("X","N","L","LN"),labels=c("HiD","HiD+N","LoD","LoD+N"))
trts$Host_trt<-paste(trts$Host,trts$trt,sep="_")
trts$Host_trt<-factor(trts$Host_trt)
trts$Host_trt_rep<-paste(trts$Host_trt,trts$rep,sep="_")
mine<-as.matrix(freqs[,-1])
mine<-log2(mine/initial_means)
mine[mine< (-8)]<- (-8)
fitness<-data.frame(trts,mine)  #### Relative fitness values with metadata
freqs<-data.frame(trts,as.matrix(freqs[,-1]))  ### Raw frequency values w/ metadata
library(ape)
tree = read.tree('../data/tree.nw')
tree$tip.label[tree$tip.label=="KH46c"]<-"KH46C"
tree$tip.label[tree$tip.label=="HM006-1"]<-"HM006.1"
tree$tip.label[tree$tip.label=="KH35c"]<-"KH35C"
tree$tip.label[tree$tip.label=="USDA1021"]<-"1021"
tree$tip.label[tree$tip.label=="USDA1157"]<-"1157"
heatmap.phylo <- function(x, Rowp, Colp, ...) {
l = length(seq(-4.9, 5, 0.1))
pal = colorRampPalette(c('#2166ac', '#f7f7f7', '#b2182b'))(l)
row_order = Rowp$tip.label[Rowp$edge[Rowp$edge[, 2] <= Ntip(Rowp), 2]]
col_order = Colp$tip.label[Colp$edge[Colp$edge[, 2] <= Ntip(Colp), 2]]
x <- x[row_order, col_order]
xl <- c(0.5, ncol(x)+0.5)
yl <- c(0.5, nrow(x)+0.5)
layout(matrix(c(0,1,0, 2,3,4, 0,5,0), nrow=3, byrow=TRUE),
width=c(3.5,    4.5, 1),
height=c(0.2, 3, 0.18))
par(mar=rep(0,4))
plot(Colp, direction="downwards", show.tip.label=FALSE,
xaxs="i", x.lim=xl)
par(mar=rep(0,4))
plot(Rowp, direction="rightwards", show.tip.label=FALSE,
yaxs="i", y.lim=yl)
lpp = .PlotPhyloEnv$last_plot.phylo
segments(lpp$xx[1:Ntip(Rowp)], lpp$yy[1:Ntip(Rowp)], par('usr')[2],
lpp$yy[1:Ntip(Rowp)], lty=3, col='grey50')
par(mar=rep(0,4), xpd=TRUE)
image((1:ncol(x))-0.5, (1:nrow(x))-0.5, t(x), col=pal,
xaxs="i", yaxs="i", axes=FALSE, xlab="",ylab="",breaks=seq(-5,5,0.1))
par(mar=rep(0,4))
plot(NA, axes=FALSE, ylab="", xlab="", yaxs="i", xlim=c(0,2), ylim=yl)
text(rep(0,nrow(x)),1:nrow(x), row_order, pos=4, family='Helvetica',
cex=1, xpd=NA)
par(mar=rep(0,4))
plot(NA, axes=FALSE, ylab="", xlab="", xaxs="i", ylim=c(0,2), xlim=xl)
text(1:ncol(x),rep(2,ncol(x)), col_order, srt=90, adj=c(1,.5), family='Helvetica',
cex=1.5)
}
as.matrix(fitness[, -1]
)
as.tibble(fitness) %>% group_by(Host_trt,strain) %>% summarise_if(is.numeric,median) %>% pivot_wider(names_from = Host_trt,values_from = fitness)
as.tibble(fitness) %>% group_by(Host_trt,strain)
library(ggplot2)
library(vegan)
library(reshape2)
library(tidyverse)
as.tibble(fitness) %>% group_by(Host_trt,strain)
as_tibble(fitness) %>% group_by(Host_trt,strain) %>% summarise_if(is.numeric,median)
as_tibble(fitness) %>% pivot_longer(cols = USDA1157:X1719,names_to= "strain",values_to = "fitness")
fitness_long<- as_tibble(fitness) %>% pivot_longer(cols = USDA1157:X1719,names_to= "strain",values_to = "fitness")
fitness_med<- fitness_long %>% group_by(Host_trt,strain) %>% summarise_if(is.numeric,median) %>% pivot_wider(names_from = Host_trt,values_from = fitness)
fitness$strain<- as.character(fitness$strain)
fitness$strain <- gsub("X","",fitness$strain) # get rid of the X's in front of the strains
fitness$strain <- gsub("USDA","",fitness$strain) # get rid of the USDA's in front of the strains
fitness_med<- fitness_long %>% group_by(Host_trt,strain) %>% summarise_if(is.numeric,median) %>% pivot_wider(names_from = Host_trt,values_from = fitness)
fitness_med$strain<- as.character(fitness$strain)
fitness_med$strain <- gsub("X","",fitness$strain) # get rid of the X's in front of the strains
fitness_med$strain <- gsub("USDA","",fitness$strain) # get rid of the USDA's in front of the strains
fitness_med
fitness_med$strain<- as.character(fitness_med$strain)
fitness_med$strain <- gsub("X","",fitness_med$strain) # get rid of the X's in front of the strains
fitness_med$strain <- gsub("USDA","",fitness_med$strain) # get rid of the USDA's in front of the strains
as.matrix(fitness_med[, -1])
View(fitness_med)
View(fitness_long)
fitness_long<- as_tibble(fitness) %>% pivot_longer(cols = USDA1157:X1719,names_to= "strain",values_to = "fitness")
fitness_med<- fitness_long %>% group_by(Host_trt,strain) %>% summarise_if(is.numeric,median) %>% pivot_wider(names_from = Host_trt,values_from = fitness)
fitness_long %>% group_by(Host_trt,strain)
fitness_long %>% group_by(Host_trt,strain) %>% summarise_if(is.numeric,median)
fitness_long %>% group_by(Host_trt,strain) %>% summarise_if(fitness,median)
fitness_long %>% group_by(Host_trt,strain) %>% summarise_if('fitness',median)
fitness_long %>% group_by(Host_trt,strain) %>% summarise('fitness',median)
fitness_long %>% group_by(Host_trt,strain) %>% summarise(fitness,median)
as.matrix(fitness_med[, -1:-2])
list(unlist(fitness_med[, 'strain']
)
)
fitness_med<- fitness_long %>% group_by(Host_trt,strain) %>% summarise_if(is.numeric,median) %>% pivot_wider(names_from = Host_trt,values_from = fitness)
fitness_med$strain<- as.character(fitness_med$strain)
fitness_med$strain <- gsub("X","",fitness_med$strain) # get rid of the X's in front of the strains
fitness_med$strain <- gsub("USDA","",fitness_med$strain) # get rid of the USDA's in front of the strains
list(unlist(fitness_med[, 'strain']))
unlist(names(fitness_med)[-1:-2]))
unlist(names(fitness_med)[-1:-2])
m = structure(as.matrix(fitness_med[, -1:-2]),
dimnames=list(unlist(fitness_med[, 'strain']),
unlist(names(fitness_med)[-1:-2])))
col_dendro = as.dendrogram(hclust(dist(t(m))))
heatmap.phylo(x = m, Rowp = tree, Colp = as.phylo(as.hclust(col_dendro)))
max(fitness_med)
max(fitness_med[,-1:2])
max(fitness_med[,-1:-2])
min(fitness_med[,-1:-2])
heatmap.phylo <- function(x, Rowp, Colp, ...) {
l = length(seq(-8, 4, 0.1))
pal = colorRampPalette(c('#2166ac','#92c5de', '#f7f7f7', '#b2182b'))(l)
row_order = Rowp$tip.label[Rowp$edge[Rowp$edge[, 2] <= Ntip(Rowp), 2]]
col_order = Colp$tip.label[Colp$edge[Colp$edge[, 2] <= Ntip(Colp), 2]]
x <- x[row_order, col_order]
xl <- c(0.5, ncol(x)+0.5)
yl <- c(0.5, nrow(x)+0.5)
layout(matrix(c(0,1,0, 2,3,4, 0,5,0), nrow=3, byrow=TRUE),
width=c(3.5,    4.5, 1),
height=c(0.2, 3, 0.18))
par(mar=rep(0,4))
plot(Colp, direction="downwards", show.tip.label=FALSE,
xaxs="i", x.lim=xl)
par(mar=rep(0,4))
plot(Rowp, direction="rightwards", show.tip.label=FALSE,
yaxs="i", y.lim=yl)
lpp = .PlotPhyloEnv$last_plot.phylo
segments(lpp$xx[1:Ntip(Rowp)], lpp$yy[1:Ntip(Rowp)], par('usr')[2],
lpp$yy[1:Ntip(Rowp)], lty=3, col='grey50')
par(mar=rep(0,4), xpd=TRUE)
image((1:ncol(x))-0.5, (1:nrow(x))-0.5, t(x), col=pal,
xaxs="i", yaxs="i", axes=FALSE, xlab="",ylab="",breaks=seq(-5,5,0.1))
par(mar=rep(0,4))
plot(NA, axes=FALSE, ylab="", xlab="", yaxs="i", xlim=c(0,2), ylim=yl)
text(rep(0,nrow(x)),1:nrow(x), row_order, pos=4, family='Helvetica',
cex=1, xpd=NA)
par(mar=rep(0,4))
plot(NA, axes=FALSE, ylab="", xlab="", xaxs="i", ylim=c(0,2), xlim=xl)
text(1:ncol(x),rep(2,ncol(x)), col_order, srt=90, adj=c(1,.5), family='Helvetica',
cex=1.5)
}
heatmap.phylo(x = m, Rowp = tree, Colp = as.phylo(as.hclust(col_dendro)))
heatmap.phylo <- function(x, Rowp, Colp, ...) {
l = length(seq(-8, 3.9, 0.1))
pal = colorRampPalette(c('#2166ac','#92c5de', '#f7f7f7', '#b2182b'))(l)
row_order = Rowp$tip.label[Rowp$edge[Rowp$edge[, 2] <= Ntip(Rowp), 2]]
col_order = Colp$tip.label[Colp$edge[Colp$edge[, 2] <= Ntip(Colp), 2]]
x <- x[row_order, col_order]
xl <- c(0.5, ncol(x)+0.5)
yl <- c(0.5, nrow(x)+0.5)
layout(matrix(c(0,1,0, 2,3,4, 0,5,0), nrow=3, byrow=TRUE),
width=c(3.5,    4.5, 1),
height=c(0.2, 3, 0.18))
par(mar=rep(0,4))
plot(Colp, direction="downwards", show.tip.label=FALSE,
xaxs="i", x.lim=xl)
par(mar=rep(0,4))
plot(Rowp, direction="rightwards", show.tip.label=FALSE,
yaxs="i", y.lim=yl)
lpp = .PlotPhyloEnv$last_plot.phylo
segments(lpp$xx[1:Ntip(Rowp)], lpp$yy[1:Ntip(Rowp)], par('usr')[2],
lpp$yy[1:Ntip(Rowp)], lty=3, col='grey50')
par(mar=rep(0,4), xpd=TRUE)
image((1:ncol(x))-0.5, (1:nrow(x))-0.5, t(x), col=pal,
xaxs="i", yaxs="i", axes=FALSE, xlab="",ylab="",breaks=seq(-5,5,0.1))
par(mar=rep(0,4))
plot(NA, axes=FALSE, ylab="", xlab="", yaxs="i", xlim=c(0,2), ylim=yl)
text(rep(0,nrow(x)),1:nrow(x), row_order, pos=4, family='Helvetica',
cex=1, xpd=NA)
par(mar=rep(0,4))
plot(NA, axes=FALSE, ylab="", xlab="", xaxs="i", ylim=c(0,2), xlim=xl)
text(1:ncol(x),rep(2,ncol(x)), col_order, srt=90, adj=c(1,.5), family='Helvetica',
cex=1.5)
}
heatmap.phylo(x = m, Rowp = tree, Colp = as.phylo(as.hclust(col_dendro)))
heatmap.phylo <- function(x, Rowp, Colp, ...) {
l = length(seq(-9, 4.9, 0.1))
pal = colorRampPalette(c('#2166ac','#92c5de', '#f7f7f7', '#b2182b'))(l)
row_order = Rowp$tip.label[Rowp$edge[Rowp$edge[, 2] <= Ntip(Rowp), 2]]
col_order = Colp$tip.label[Colp$edge[Colp$edge[, 2] <= Ntip(Colp), 2]]
x <- x[row_order, col_order]
xl <- c(0.5, ncol(x)+0.5)
yl <- c(0.5, nrow(x)+0.5)
layout(matrix(c(0,1,0, 2,3,4, 0,5,0), nrow=3, byrow=TRUE),
width=c(3.5,    4.5, 1),
height=c(0.2, 3, 0.18))
par(mar=rep(0,4))
plot(Colp, direction="downwards", show.tip.label=FALSE,
xaxs="i", x.lim=xl)
par(mar=rep(0,4))
plot(Rowp, direction="rightwards", show.tip.label=FALSE,
yaxs="i", y.lim=yl)
lpp = .PlotPhyloEnv$last_plot.phylo
segments(lpp$xx[1:Ntip(Rowp)], lpp$yy[1:Ntip(Rowp)], par('usr')[2],
lpp$yy[1:Ntip(Rowp)], lty=3, col='grey50')
par(mar=rep(0,4), xpd=TRUE)
image((1:ncol(x))-0.5, (1:nrow(x))-0.5, t(x), col=pal,
xaxs="i", yaxs="i", axes=FALSE, xlab="",ylab="",breaks=seq(-5,5,0.1))
par(mar=rep(0,4))
plot(NA, axes=FALSE, ylab="", xlab="", yaxs="i", xlim=c(0,2), ylim=yl)
text(rep(0,nrow(x)),1:nrow(x), row_order, pos=4, family='Helvetica',
cex=1, xpd=NA)
par(mar=rep(0,4))
plot(NA, axes=FALSE, ylab="", xlab="", xaxs="i", ylim=c(0,2), xlim=xl)
text(1:ncol(x),rep(2,ncol(x)), col_order, srt=90, adj=c(1,.5), family='Helvetica',
cex=1.5)
}
col_dendro = as.dendrogram(hclust(dist(t(m))))
heatmap.phylo(x = m, Rowp = tree, Colp = as.phylo(as.hclust(col_dendro)))
heatmap.phylo <- function(x, Rowp, Colp, ...) {
l = length(seq(-8, 3.9, 0.1))
pal = colorRampPalette(c('#2166ac','#92c5de', '#f7f7f7', '#b2182b'))(l)
row_order = Rowp$tip.label[Rowp$edge[Rowp$edge[, 2] <= Ntip(Rowp), 2]]
col_order = Colp$tip.label[Colp$edge[Colp$edge[, 2] <= Ntip(Colp), 2]]
x <- x[row_order, col_order]
xl <- c(0.5, ncol(x)+0.5)
yl <- c(0.5, nrow(x)+0.5)
layout(matrix(c(0,1,0, 2,3,4, 0,5,0), nrow=3, byrow=TRUE),
width=c(3.5,    4.5, 1),
height=c(0.2, 3, 0.18))
par(mar=rep(0,4))
plot(Colp, direction="downwards", show.tip.label=FALSE,
xaxs="i", x.lim=xl)
par(mar=rep(0,4))
plot(Rowp, direction="rightwards", show.tip.label=FALSE,
yaxs="i", y.lim=yl)
lpp = .PlotPhyloEnv$last_plot.phylo
segments(lpp$xx[1:Ntip(Rowp)], lpp$yy[1:Ntip(Rowp)], par('usr')[2],
lpp$yy[1:Ntip(Rowp)], lty=3, col='grey50')
par(mar=rep(0,4), xpd=TRUE)
image((1:ncol(x))-0.5, (1:nrow(x))-0.5, t(x), col=pal,
xaxs="i", yaxs="i", axes=FALSE, xlab="",ylab="",breaks=seq(-8,4,0.1))
par(mar=rep(0,4))
plot(NA, axes=FALSE, ylab="", xlab="", yaxs="i", xlim=c(0,2), ylim=yl)
text(rep(0,nrow(x)),1:nrow(x), row_order, pos=4, family='Helvetica',
cex=1, xpd=NA)
par(mar=rep(0,4))
plot(NA, axes=FALSE, ylab="", xlab="", xaxs="i", ylim=c(0,2), xlim=xl)
text(1:ncol(x),rep(2,ncol(x)), col_order, srt=90, adj=c(1,.5), family='Helvetica',
cex=1.5)
}
heatmap.phylo(x = m, Rowp = tree, Colp = as.phylo(as.hclust(col_dendro)))
pdf(file="../figures/FigX_heatmap_Phylo.pdf",width = 5,height=8, useDingbats=FALSE)
heatmap.phylo(x = m, Rowp = tree, Colp = as.phylo(as.hclust(col_dendro)))
dev.off()
l = length(seq(-8, 3.9, 0.1))
pal = colorRampPalette(c('#2166ac','#92c5de', '#f7f7f7', '#b2182b'))(l)
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
#text(y=0, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
text(y=0, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
text(y=0, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
#text(y=0, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
#text(y=0, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
dev.off()
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
rasterImage(legend_image, 0, 0, 2,2)
dev.off()
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
text(y=0, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
dev.off()
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
text(y=-.2, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
#text(y=-0.2, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
pdf(file="../figures/FigX_heatmap_legend.pdf",height = 1, width = 8)
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
#text(y=-0.2, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
dev.off()
dev.off()
dev.off()
pdf(file="../figures/FigX_heatmap_legend.pdf",height = 1, width = 8)
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
#text(y=-0.2, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
dev.off()
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
#text(y=-0.2, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
pdf(file="../figures/FigX_heatmap_legend.pdf",height = 1, width = 8)
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
#text(y=-0.2, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
dev.off()
dev.off()
pdf(file="../figures/FigX_heatmap_legend.pdf",height = 1, width = 8)
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
#text(y=-0.2, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
dev.off()
pdf(file="../figures/FigX_heatmap_legend.pdf",height = 2, width = 8)
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
#text(y=-0.2, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
dev.off()
pdf(file="../figures/FigX_heatmap_legend.pdf",height = 2, width = 4)
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
#text(y=-0.2, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
dev.off()
pdf(file="../figures/FigX_heatmap_legend.pdf",height = 3, width = 4)
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
#text(y=-0.2, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
dev.off()
pdf(file="../figures/FigX_heatmap_legend.pdf",height = 3, width = 6)
legend_image <- as.raster(matrix(pal, nrow=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '')
#text(y=-0.2, x = seq(0,2,l=4), labels = seq(-8,4,l=4))
rasterImage(legend_image, 0, 0, 2,2)
dev.off()
heatmap.phylo(x = m, Rowp = tree, Colp = as.phylo(as.hclust(col_dendro)))
